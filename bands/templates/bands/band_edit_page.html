{% extends 'base.html' %}

{% block content %}

<!-- Modals -->
<div class="modal fade" id="bandExists">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-warning" style="background:black; padding:10px;">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title text-warning">Upozorenje !!!</h4>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="text-justify">
                    <h5>Mogući razlozi za ovo upozorenje:</h5>
                    <ul>
                        <li>Ime benda i lokacija njegovog osnivanja koje ste uneli se podudara sa već postojećim bendom
                            u bazi. Iz tog razloga ne možemo da prihvatimo podatke koje ste uneli.</li>
                        <li>Uneli ste u polja <b>Članovi benda</b>, <b>Kratka biografija</b>
                            veći broj karaktera nego što je dozvoljeno.</li>
                    </ul>
                    <p>Hvala na razumevanju i molimo vas pokušajte ponovo.</p>
                </div>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-warning btn-block text-uppercase text-light font-weight-bold" data-dismiss="modal">Ok</button>
            </div>

        </div>
    </div>
</div>

<br><br>
<div class="container">
    <div class="edit_band">
        <br><br><br>
        <h3 class="page-titles"><i class="far fa-edit"></i>&nbsp;&nbsp;{{ band_profile.name }}</h3>
        <br>
        <form method="post" action="{{ action_url }}" enctype="multipart/form-data" id="edit_band"> {% csrf_token %}
            {% if form.errors %}
            <script>
                $('#bandExists').modal('show')
            </script>
            {% endif %}
            {{ form.media }}
            <div class="row">
                <div class="col-md-6 text-center">
                    <div class="fieldWrapper">
                        <h6 class="text-left">Ime Benda:</h6>
                        <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                               placeholder="" name="name" required="" id="id_band_name"
                               value="{{ band_profile.name }}"
                               oninvalid="this.setCustomValidity('Molimo vas unesite ime benda.')"
                               oninput="setCustomValidity('')">
                        <div style="text-align:right;">
                            <small>* Ime benda čiju stranicu uređujete.</small>
                        </div>
                    </div>
                    <div class="text-center">
                        {% if band_profile.logo %}
                        <img id="band_logo" src="{{ band_profile.logo.url }}" class="img-fluid">
                        {% else %}
                        <img id="band_logo" src="/static/image_&_video/logo_of_bend.png" class="img-fluid">
                        {% endif %}
                    </div>
                    <br>
                    <label for="logo"
                           style="cursor: pointer;"
                           class="btn btn-block"
                           id="logo_dugme">Promeni logo</label>
                    <input type="file" name="logo" id="logo" style="display: none;">
                    <br>
                    {% if band_profile.band_picture %}
                    <img id="band_image_upload" src="{{ band_profile.band_picture.url }}" class="img-fluid">
                    {% else %}
                    <img id="band_image_upload" src="/static/image_&_video/picture_of_bend.png" class="img-fluid">
                    {% endif %}
                    <br><br>
                    <label for="band_picture"
                           style="cursor: pointer;"
                           class="btn btn-block"
                           id="band_picture_dugme">Dodaj sliku benda</label>
                    <input type="file" name="band_picture" id="band_picture" style="display: none;">
                    <div class="naslovi text-justify">
                        <h6>Žanr:</h6>
                        <select name="genre" id="id_genre">
                            <option value="{{ band_profile.genre.id }}">{{ band_profile.genre }}</option>
                            <option disabled>Rock</option>
                            {% for g in genre %}
                            {% if g.main_genre == "Rock" %}
                            <option value="{{ g.id }}">&nbsp;&nbsp;&nbsp;{{ g.genre }}</option>
                            {% endif %}
                            {% endfor %}
                            <option disabled>Punk</option>
                            {% for g in genre %}
                            {% if g.main_genre == "Punk" %}
                            <option value="{{ g.id }}">&nbsp;&nbsp;&nbsp;{{ g.genre }}</option>
                            {% endif %}
                            {% endfor %}
                            <option disabled>Metal</option>
                            {% for g in genre %}
                            {% if g.main_genre == "Metal" %}
                            <option value="{{ g.id }}">&nbsp;&nbsp;&nbsp;{{ g.genre }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                        <div style="text-align:right;">
                            <small>* Muzički žanr benda.</small>
                        </div>
                    </div>
                    <div class="naslovi text-justify">
                        <h6>Lokacija:</h6>
                        <div class="grad">
                            <select name="city_or_town" id="id_city_or_town" required>
                                <option value="{{ band_profile.city_or_town.id }}">{{ band_profile.city_or_town }}</option>
                                {% for l in location %}
                                <option value="{{ l.id }}">&nbsp;&nbsp;&nbsp;{{ l.place }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div style="text-align:right;">
                            <small>* Ime mesta iz kog bend potiče.</small>
                        </div>
                    </div>
                    <div class="fieldWrapper">
                        <h6 class="text-left">Godina nastanka:</h6>
                        {% if band_profile.year_of_creation != None %}
                        <input autocomplete="off" class="form-cotrol" type="number" pattern="\d*" style="width: 100%;"
                               placeholder="" name="year_of_creation" id="id_year_of_creation"
                               value="{{ band_profile.year_of_creation }}"
                               oninvalid="this.setCustomValidity('Molimo vas unesite godinu brojevima.')"
                               oninput="setCustomValidity('')">
                        {% else %}
                        <input autocomplete="off" class="form-cotrol" type="number" pattern="\d*" style="width: 100%;"
                               placeholder="" name="year_of_creation" id="id_year_of_creation"
                               oninvalid="this.setCustomValidity('Molimo vas unesite godinu brojevima.')"
                               oninput="setCustomValidity('')">
                        {% endif %}
                        <div style="text-align:right;">
                            <small>* Godina kada je bend osnovan.</small>
                        </div>
                    </div>
                    <div class="text-left">
                        <h6>Članovi benda:</h6>
                        {{ form.members }}
                    </div>
                    <div style="text-align:right;">
                        <small>* Imena članova benda do 1000 karaktera.</small>
                    </div>
                    <br>
                </div>
                <div class="col-md-6">
                    <div class="text-left">
                        <h6>Kratka biografija:</h6>
                        {{ form.bio }}
                    </div>
                    <div style="text-align:right;">
                        <small>* Kratka biografija benda 2000 karaktera.</small>
                    </div>
                    <br>
                    <div>
                        {% if band_profile.activity is True %}
                        <label id="check"><input type="checkbox" name="activity" id="id_activity" style="font-weight: 600;" checked> Da li je bend aktivan</label>
                        {% else %}
                        <label id="check"><input type="checkbox" name="activity" id="id_activity" style="font-weight: 600;"> Da li je bend aktivan</label>
                        {% endif %}
                    </div>
                    <br>
                    <div class="frame">
                        <h5><i class="fas fa-link"></i>&nbsp;&nbsp;Spoljni Linkovi:</h5>
                        <br>
                        <div class="fieldWrapper">
                            <h6>YT link:</h6>
                            {% if band_profile.yt_video1 != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video1" maxlength="250" id="id_yt_video1"
                                   value="{{ band_profile.yt_video1 }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video1" maxlength="250" id="id_yt_video1">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link vaše pesme sa YT.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>YT link:</h6>
                            {% if band_profile.yt_video2 != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video2" maxlength="250" id="id_yt_video2"
                                   value="{{ band_profile.yt_video2 }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video2" maxlength="250" id="id_yt_video2">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link vaše pesme sa YT.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>YT link:</h6>
                            {% if band_profile.yt_video3 != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video3" maxlength="250" id="id_yt_video3"
                                   value="{{ band_profile.yt_video3 }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="yt_video3" maxlength="250" id="id_yt_video3">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link vaše pesme sa YT.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>YouTube kanal:</h6>
                            {% if band_profile.youtube != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="youtube" maxlength="200" id="id_youtube"
                                   value="{{ band_profile.youtube }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="youtube" maxlength="200" id="id_youtube">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link za YT kanal benda.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>Facebook strana:</h6>
                            {% if band_profile.facebook != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="facebook" maxlength="200" id="id_facebook"
                                   value="{{ band_profile.facebook }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="facebook" maxlength="200" id="id_facebook">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link za vašu Facebook stranu benda.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>Soundcloud strana:</h6>
                            {% if band_profile.soundcloud != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="soundcloud" maxlength="200" id="id_soundcloud"
                                   value="{{ band_profile.soundcloud }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="soundcloud" maxlength="200" id="id_soundcloud">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link za vašu Soundcloud stranicu.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>Instagram strana:</h6>
                            {% if band_profile.instagram != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="instagram" maxlength="200" id="id_instagram"
                                   value="{{ band_profile.instagram }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="instagram" maxlength="200" id="id_instagram">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link ka vašoj Instagram stranici.</small>
                            </div>
                        </div>
                        <div class="fieldWrapper">
                            <h6>Bandcamp strana:</h6>
                            {% if band_profile.band_camp != None %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="band_camp" maxlength="200" id="id_band_camp"
                                   value="{{ band_profile.band_camp }}">
                            {% else %}
                            <input autocomplete="off" class="form-cotrol" type="text" style="width: 100%;"
                                   placeholder="" name="band_camp" maxlength="200" id="id_band_camp">
                            {% endif %}
                            <div style="text-align:right;">
                                <small>* Unesite link ka vašoj Bandcamp stranici.</small>
                            </div>
                        </div>
                    </div>
                    <br>
                </div>
            </div>
            <div class="text-justify frame info">
                <h5><i class="fas fa-info-circle fa-lg"></i>&nbsp;&nbsp;Uputstvo</h5>
                <ul>
                    <li>
                        Obavezna polja profilne stranice benda su "<b class="bold">IME BENDA</b>" i
                        "<b class="bold">LOKACIJA</b>".
                    </li>
                    <li>
                        Polja "<b class="bold">ČLANOVI BENDA</b>" i "<b class="bold">KRATKA BIOGRAFIJA</b>" pružaju
                        mogućnost stilizovanja teksta unutar njih samih. Ograničena su na 1000 i 2000 karaktera.
                    </li>
                    <li>
                        Polja ispod naslova "<b class="bold">SPOLJNI LINKOVI</b>" popunjavaju se kopiranjem linka iz
                        address bar-a i nalepite ga u polje koje mu odgovara. Naša web strana će prepoznati da li
                        ste uneli pravilan link.
                    </li>
                </ul>
                <p>
                    Ako vam je bilo šta nejasno oko kreiranja stranice benda, ne
                    ustručavajte se da postavite pitanje našem timu za podršku. Možete nas kontaktirati
                    putem email-a na strani <b class="bold">POMOĆ</b>.
                </p>
            </div>
            <br>
            <div style="display: flex;">
                <a href="/band/account/page/{{ band_profile.id }}/"
                   class="btn"
                   style="width: 50%; margin: 2px;"
                   id="id_nazad">Nazad</a>
                <br>
                <button type="submit"
                        class="btn"
                        name="profil"
                        style="width: 50%; margin: 2px;"
                        id="id_sacuvaj">Sačuvaj</button>
            </div>
        </form>
        <br>
    </div>
</div>

<script>
    function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#band_logo').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
        }
    }

    function readURL2(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#band_image_upload').attr('src', e.target.result);
        }

        reader.readAsDataURL(input.files[0]);
        }
    }

    $("#logo").change(function(){
        readURL(this);
    });

    $("#band_picture").change(function(){
        readURL2(this);
    });
</script>

<script>
    $("#edit_band").submit(function() {
        if (window.File && window.FileReader && window.FileList && window.Blob) {
            var logo = $('#logo')[0].files[0];

        if (logo && logo.size > 2 * 1024 * 1024) {
            alert("Slika '" + logo.name + "' koju ste odabrali\nza logo je prevelika.\nNajveća dozvoljena veličina je 2.5mb.");
            return false;
            }
        }
    });
</script>

<script>
    $("#edit_band").submit(function() {
        if (window.File && window.FileReader && window.FileList && window.Blob) {
            var file = $('#band_picture')[0].files[0];

        if (file && file.size > 2 * 1024 * 1024) {
            alert("Slika '" + file.name + "' koju ste odabrali\nza sliku benda je prevelika.\nNajveća dozvoljena veličina je 2.5mb.");
            return false;
            }
        }
    });
</script>

{% endblock %}